console.log("=== SISTEMA DE GESTI√ìN DE TAREAS (TODO LIST) ===\n");

// Factory de todo list usando closures
function crearTodoList() {
  let tareas = [];
  let idCounter = 1;

  // Funci√≥n privada para validar texto
  const validarTexto = (texto = "") =>
    texto.trim().length > 0 || (() => { throw new Error("‚ùå El nombre de la tarea no puede estar vac√≠o."); })();

  return {
    // Agregar tarea con par√°metros avanzados (...tags)
    agregarTarea: (nombre, ...tags) => {
      try {
        validarTexto(nombre);

        const nueva = {
          id: idCounter++,
          nombre,
          completada: false,
          tags: tags.length ? tags : ["general"],
          fecha: new Date().toLocaleString()
        };

        tareas.push(nueva);
        console.log(`üìù Tarea agregada: "${nombre}" (id: ${nueva.id})`);
      } catch (error) {
        console.log(error.message);
      }
    },

    // Marcar como completada
    completarTarea: (id) => {
      try {
        const tarea = tareas.find(t => t.id === id);
        if (!tarea) throw new Error(`‚ùå No existe una tarea con id ${id}.`);

        tarea.completada = true;
        console.log(`‚úîÔ∏è Tarea completada: "${tarea.nombre}"`);
      } catch (error) {
        console.log(error.message);
      }
    },

    // Filtrar tareas (estado: "todas", "completadas", "pendientes")
    filtrar: (estado = "todas") => {
      switch (estado) {
        case "completadas":
          return tareas.filter(t => t.completada);

        case "pendientes":
          return tareas.filter(t => !t.completada);

        case "todas":
        default:
          return [...tareas]; // copia segura
      }
    },

    // Obtener estad√≠sticas
    obtenerEstadisticas: () => {
      const total = tareas.length;
      const completadas = tareas.filter(t => t.completada).length;
      const pendientes = total - completadas;

      return {
        total,
        completadas,
        pendientes,
        porcentaje: total === 0 ? 0 : ((completadas / total) * 100).toFixed(1)
      };
    },

    // Obtener todas (copia)
    obtenerTareas: () => [...tareas]
  };
}

// Crear instancia del TODO list
const todo = crearTodoList();

// === Agregar tareas ===
todo.agregarTarea("Estudiar JavaScript", "estudio", "programaci√≥n");
todo.agregarTarea("Hacer ejercicio");
todo.agregarTarea("Comprar comida", "casa");
todo.agregarTarea("Preparar presentaci√≥n", "trabajo");

// === Completar una tarea ===
todo.completarTarea(2);

// === Filtros ===
console.log("\n=== Tareas completadas ===");
console.log(todo.filtrar("completadas"));

console.log("\n=== Tareas pendientes ===");
console.log(todo.filtrar("pendientes"));

console.log("\n=== Todas las tareas ===");
console.log(todo.obtenerTareas());

// === Estad√≠sticas ===
console.log("\n=== ESTAD√çSTICAS ===");
console.log(todo.obtenerEstadisticas());
